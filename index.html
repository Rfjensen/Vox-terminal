<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VOX Recruitment Terminal</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
      color: #0f0;
      font-family: 'Share Tech Mono', monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      background-image: radial-gradient(#0f0 1px, transparent 1px);
      background-size: 20px 20px;
    }
    .terminal {
      background-color: rgba(0, 0, 0, 0.9);
      padding: 40px;
      border: 2px solid #0f0;
      box-shadow: 0 0 30px #0f0;
      max-width: 800px;
      width: 90%;
    }
    .terminal-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #000;
      padding: 30px;
      border: 2px dashed #0f0;
      z-index: 10;
      display: none;
    }
    .terminal-header {
      margin-bottom: 20px;
      color: #0f0;
      font-weight: bold;
    }
    .input-line {
      display: flex;
      align-items: center;
      margin-top: 20px;
    }
    .input-line input {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid #0f0;
      color: #0f0;
      font-size: 1rem;
      font-family: 'Share Tech Mono', monospace;
      outline: none;
      padding: 8px;
    }
    .command-list {
      white-space: pre;
      font-family: 'Share Tech Mono', monospace;
      line-height: 1.5;
      margin-top: 10px;
    }
    .clue-text {
      font-style: italic;
      margin-bottom: 10px;
      color: #0f0;
    }
    #unlockMessage {
      margin-top: 15px;
      color: #0f0;
      font-weight: bold;
    }
    #hackerNoise {
      display: none;
      white-space: pre-wrap;
      color: #0f0;
      font-size: 0.85rem;
      line-height: 1.3;
      max-height: 300px;
      overflow-y: auto;
    }
    .blinking {
      animation: blink 1s step-start infinite;
    }
    @keyframes blink {
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="terminal" id="mainTerminal">
    <div class="terminal-header">> VOX RECRUITMENT TERMINAL</div>
    <div class="clue-text">"Speak the phrase hidden in this domain."</div>
    <button onclick="startVoiceRecognition()">Start Voice Recognition</button>
    <div id="voiceFeedback"></div>
    <div id="mainOutput"></div>
    <div class="command-list" id="commandList" style="display:none;">
> help
> Available Commands:
  - trace               ............ locate active node
  - vox.status          ............ check diagnostics
  - decrypt node        ............ solve cipher
  - access.redacted     ............ decrypt VOX log
  - vox.protocol.init   ............ [locked]
    </div>
    <div class="input-line">
      <input type="text" id="commandInput" placeholder="Enter command or answer...">
    </div>
    <div id="unlockMessage"></div>
  </div>

  <div class="terminal-overlay" id="puzzleOverlay">
    <div class="terminal-header">> PUZZLE TERMINAL</div>
    <div id="puzzleOutput">Decrypt this: R1 E2 D3 A4 C5 T6<br>Rearrange to unlock.</div>
    <input type="text" id="puzzleInput" placeholder="Enter solution...">
    <button onclick="checkPuzzleSolution()">Submit</button>
    <button onclick="closePuzzle()">Close</button>
  </div>

  <div id="hackerNoise"></div>

  <script>
    const commandInput = document.getElementById('commandInput');
    const commandList = document.getElementById('commandList');
    const output = document.getElementById('mainOutput');
    const unlockMessage = document.getElementById('unlockMessage');
    const puzzleOverlay = document.getElementById('puzzleOverlay');
    const puzzleInput = document.getElementById('puzzleInput');
    const hackerNoise = document.getElementById('hackerNoise');

    let voiceUnlocked = false;
    let puzzlesSolved = 0;

    function startVoiceRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        document.getElementById('voiceFeedback').innerText = "Speech recognition not supported.";
        return;
      }
      const recognition = new SpeechRecognition();
      recognition.lang = 'en-US';
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript.toLowerCase();
        if (transcript.includes("we listen to silence")) {
          document.getElementById('voiceFeedback').innerText = "Access granted.";
          voiceUnlocked = true;
          showHelp();
        } else {
          document.getElementById('voiceFeedback').innerText = "Access denied. Try again.";
        }
      };
      recognition.start();
    }

    function showHelp() {
      commandList.style.display = 'block';
    }

    commandInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const cmd = commandInput.value.trim().toLowerCase();
        commandInput.value = '';
        runCommand(cmd);
      } else if (e.key === 'Tab') {
        e.preventDefault();
        autoCompleteCommand();
      }
    });

    function autoCompleteCommand() {
      const val = commandInput.value.toLowerCase();
      const commands = ['trace', 'vox.status', 'decrypt node', 'access.redacted', 'vox.protocol.init'];
      const match = commands.find(c => c.startsWith(val));
      if (match) commandInput.value = match;
    }

    function runCommand(cmd) {
      if (!voiceUnlocked) {
        output.innerHTML += `> ${cmd}<br>ACCESS DENIED<br>`;
        return;
      }

      output.innerHTML += `> ${cmd}<br>`;

      switch(cmd) {
        case 'help':
          showHelp();
          break;
        case 'trace':
          output.innerHTML += 'NODE TRACE: SIGIL-1134 ACTIVE<br>';
          break;
        case 'vox.status':
          output.innerHTML += 'UPLINK: STABLE<br>GRID: INTERFERENCE DETECTED<br>';
          break;
        case 'decrypt node':
        case 'access.redacted':
          openPuzzle();
          break;
        case 'vox.protocol.init':
          if (puzzlesSolved >= 2) {
            runFinalSequence();
          } else {
            output.innerHTML += 'Command Locked. Solve required puzzles.<br>';
          }
          break;
        default:
          output.innerHTML += 'Unknown command. Type \"help\".<br>';
      }
    }

    function openPuzzle() {
      puzzleOverlay.style.display = 'block';
    }

    function closePuzzle() {
      puzzleOverlay.style.display = 'none';
    }

    function checkPuzzleSolution() {
      const answer = puzzleInput.value.trim().toLowerCase();
      if (answer === 'redact' || answer === 'silence') {
        output.innerHTML += `PUZZLE SOLVED: ${answer.toUpperCase()}<br>`;
        puzzlesSolved++;
        closePuzzle();
        if (puzzlesSolved >= 2) {
          unlockMessage.innerHTML = '> vox.protocol.init is now unlocked';
        }
      } else {
        puzzleOverlay.querySelector('#puzzleOutput').innerHTML += '<br>Incorrect. Try again.';
      }
    }

    function runFinalSequence() {
      hackerNoise.style.display = 'block';
      let log = '';
      let count = 0;
      const interval = setInterval(() => {
        log += `> TRACE ${Math.random().toString(36).substring(2, 10).toUpperCase()} ... LINK STABILIZED\n`;
        hackerNoise.textContent = log;
        count++;
        if (count >= 10) {
          clearInterval(interval);
          revealFinal();
        }
      }, 300);
    }

    function revealFinal() {
      hackerNoise.innerHTML += `
        <br><br><strong>FINAL PROTOCOL RECEIVED</strong><br>
        Meet Cipher-9 in Ember Row beneath the mural with no name.
        <br><br>
        <div style="border: 2px solid #0f0; padding: 16px; margin-top: 20px; max-width: 320px; background: rgba(0,0,0,0.8); font-family: 'Share Tech Mono', monospace;">
          <div style="font-weight: bold; color: #0f0;">:: VOX IDENT CARD ::</div>
          <div style="margin-top: 8px;">
            <span style="color:#999;">Designation:</span> <span style="color:#0f0;">Cipher-9</span><br>
            <span style="color:#999;">Rank:</span> <span style="color:#0f0;">Initiate Node</span><br>
            <span style="color:#999;">Status:</span> <span style="color:#0f0;">Activated</span><br>
            <span style="color:#999;">ID Code:</span> <span style="color:#0f0;">VX-███-93X</span>
          </div>
          <div style="margin-top: 12px; font-size: 0.75rem; color:#999;">
            Transmission secured.<br>
            Echo node authentication confirmed.
          </div>
        </div>
      `;
    }
  </script>
</body>
</html>
